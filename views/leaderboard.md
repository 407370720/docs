# 排行榜服务总览

排行榜是每个游戏的必备功能，通过 LeanCloud 可以非常简单的实现排行榜，帮助您快速增加用户活跃。


## 功能简介

##### 自动计算排名
您只需将玩家的数据更新到指定的排行榜中，我们会自动帮您计算排名。

##### 获取前排数据
根据您的需求轻松获取前 10 或前 n 等前排数据。

##### 获取当前玩家附近的排名
当您希望为当前玩家匹配势均力敌的对手时，通过相关接口获取当前玩家排名附近的玩家，为他们自动匹配或展示名单供用户自行邀请。

##### 数据重置
* 自动重置：支持自动定期重置数据，当一个赛季结束时自动重置排行榜。
* 手动重置：当您认为当前的比赛数据有失公平时或者是测试数据时，也可以手动重置排行榜。
* 排行榜的历史版本数据会被保存到 JSON 文件中，您可以根据玩家的历史战绩发放相应的奖品。

##### 方便的数据更新模式
提供 better / last 两种分数更新模式，更新数据更简单。

* better：当前玩家多次更新分数时，根据排行榜的排序选择是否覆盖服务端的分数。
* last：当前玩家多次更新分数时，每次都写入最新数据。

## 功能详解

每一个排行榜由名称（statisticName）及所有玩家的分数（score）组成，并可以设置排序、更新策略及重置周期。我们推荐您在控制台提前创建排行榜，客户端更新分数时，通过指定排行榜名称（statisticName）来更新分数。

### 名称
statisticName 是排行榜唯一名称，不可修改，只能包含字母、数字、下划线，并且以字母或数字开头。

### 分数
score 是用户在客户端产生的游戏分数。

### 排序策略
order 代表排序策略，默认为 descending，排名按分数由高到低排列，如果设置为 ascending ，则排名按分数由低到高排列。

### 更新策略
updateStrategy 代表更新策略。

* 默认更新策略选择 better，那么会根据 order 来判断是否更新玩家的分数，即以玩家最好的分数为准。
  * order 为 descending：只会更新成绩比服务端大的分数。如果当前玩家的分数大于服务端的分数，服务端执行更新策略，反之服务端会保留之前的分数。
  * order 为 ascending：只会更新成绩比服务端小的分数。如果当前玩家的分数小于服务端的分数，服务端执行更新策略，反之服务端会保留之前的分数。这
* 如果更新策略选择 last，每次玩家更新分数时都会覆盖掉服务端之前的数据，即总是以用户当前的最新数据为准。

### 数据重置
#### 重置时间及周期
排行榜可以被重置，重置后线上所有数据清零。例如您可以每月开展赛季，赛季结束后所有数据清零，所有玩家重新开始比赛排名；也可以在发现当前比赛数据有失平衡时清空数据重新开始。从重置时间开始的一刻起，所有老数据被清理，客户端再发起的更新分数的请求将自动进入新版本的数据中。

versionChangeInterval 代表数据重置周期，有以下选项：
* hour：每小时整点重置一次。例如 00:00，01:00
* day：每天凌晨 00:00 重置一次。
* week：每周一凌晨 00:00 重置一次。
* month：每月 1 日凌晨 00:00 重置一次。
* Never：从来不自动重置，在必要的时候手动重置。

**对于需要在凌晨 00:00 重置的周期（day/week/month）：**
* 如果应用在国内节点，会在北京时间凌晨 00:00 重置，也就是 UTC 标准时间 `16:00Z`。
* 如果应用在美国节点，会在 UTC 标准时间 `00:00Z` 重置


#### 历史数据
历史数据被重置后将会保存在 csv 文件中供您下载。
每个排行榜最多保存 200 个历史数据文件，超出后最老的版本文件会被删掉，因此请及时处理您的历史数据，例如您需要在一周内处理按 hour 自动重置的数据。

## 开始使用


* [Demo](https://leancloud.github.io/javascript-sdk/demo/leaderboard/)及[源码](https://github.com/leancloud/javascript-sdk/blob/master/demo/leaderboard/)：通过非常小的一个 Demo 来展示排行榜功能。
* [JavaScript 排行榜开发指南](leaderboard_guide-js.html)：对如何开发排行榜进行了详细介绍。
