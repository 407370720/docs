# 排行榜服务总览

排行榜是每个游戏的必备功能，通过 LeanCloud 可以非常简单的实现排行榜，帮助您快速增加用户活跃。


## 功能简介
##### 自动计算排名
您只需将玩家的成绩更新到指定的排行榜中，我们会自动帮您计算排名。

##### 获取前排数据
根据您的需求轻松获取前 10 或前 n 等前排数据。

##### 获取当前玩家的排名
即使当前玩家没有名列前茅，也可以获取他在排行中的具体名次，以此了解到当前玩家和前排玩家的差距。

##### 获取当前玩家附近排名的玩家
如果您希望为当前玩家寻找水平相当的对手或好友，只需调用一个接口就可以获得您想要的数据。

##### 数据重置
* 自动重置：支持自动定期重置数据，当一个赛季结束时自动重置排行榜。
* 手动重置：当您认为当前的比赛数据有失公平或者是测试数据时，可以手动重置排行榜。
* 排行榜的历史版本数据会被保存到 JSON 文件中，您可以根据玩家的历史战绩发放相应的奖品。

##### 方便的数据更新模式
提供 better / last 两种分数更新模式，更新数据更简单。

* better：玩家多次更新分数时，保留最好的成绩，
* last：玩家多次更新分数时，保留最新的成绩。

## 功能详解

每一个排行榜由名称（statisticName）及所有玩家的成绩（statisticValue）组成，并可以设置排序、更新策略及重置周期。我们推荐您在控制台提前创建排行榜，客户端更新分数时，通过指定排行榜名称（statisticName）来更新分数。

### 名称
statisticName 是排行榜唯一名称，不可修改，只能包含字母、数字、下划线，并且以字母或数字开头。

### 成绩
statisticValue 是用户在客户端产生的成绩，可以是整数，也可以带有小数点。

### 排序策略
排序策略 order 默认为 descending，可以修改为 ascending。
* descending：排名按分数由高到低排列，例如在《跳一跳》中，玩家的分数越大排名越高。
* ascending：则排名按分数由低到高排列，例如在某些竞速游戏中，完成任务的时间越短排名越高。

### 更新策略
updateStrategy 代表更新策略。

* 默认更新策略选择 better，那么会根据 order 来判断是否更新玩家的分数，总是保留玩家**最好的**分数为准。
  * order 为 descending：只会更新比之前成绩更大的分数。例如当前玩家要更新的成绩为 100 ，排行榜中的成绩为 200，排行榜保留最大的分数 200。
  * order 为 ascending：只会更新比之前成绩更小的分数。例如当前玩家要更新的成绩为 1.2，排行榜中的成绩为 1.5，排行榜会将数据更新为 1.2。
* 如果更新策略选择 last，每次玩家更新分数时都会覆盖掉服务端之前的数据，即总是保留玩家**最新的**数据。

### 数据重置
#### 重置时间及周期
排行榜可以被重置，重置后线上所有数据清零。例如您可以每月开展赛季，赛季结束后所有数据清零，所有玩家重新开始比赛排名；也可以在发现当前比赛数据有失平衡时清零数据重新开始。从重置时间开始的一刻起，所有老数据被清理，客户端再发起的更新分数的请求将自动进入新版本的数据中。

versionChangeInterval 代表数据重置周期，有以下选项：
* hour：每个整点重置。例如 00:00，01:00。
* day：每天凌晨 00:00 重置。
* week：每周一凌晨 00:00 重置。
* month：每月 1 日凌晨 00:00 重置。
* Never：不自动重置，在必要的时候手动重置。

##### 不同节点的重置时间
请注意，**不同节点的重置时间不同**，对于需要在凌晨 00:00 重置的周期（day/week/month）：

* 如果应用在国内节点，会在北京时间凌晨 00:00 重置。
* 如果应用在美国节点，会在 UTC 标准时间 `00:00Z` 重置。


#### 历史数据
* 历史数据被重置后将会保存在 csv 文件中供您下载。
* 每个排行榜最多保存 200 个历史数据文件，**超出后最老的版本文件会被删掉**，因此请及时处理您的历史数据。例如您需要在一周内处理按 hour 自动重置的数据，避免出现处理数据时已经被删掉的情况。

## 开始使用
* [Demo](https://leancloud.github.io/javascript-sdk/demo/leaderboard/)及[源码](https://github.com/leancloud/javascript-sdk/blob/master/demo/leaderboard/)：通过一个 Demo 来展示排行榜功能。
* [JavaScript 排行榜开发指南](leaderboard_guide-js.html)：对如何开发排行榜进行了详细介绍。
